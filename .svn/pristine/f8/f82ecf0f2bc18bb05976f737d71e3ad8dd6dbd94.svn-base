<?php

/**
 * 物流查询 
 * 适用与阿里云市场 杭州网尚科技 全国快递查询接口
 *  wang修 2018年3月15日
 * @author liuchenwei@hnzhimo.com
 * @copyright (c) 2017, 河南知默网络科技有限公司
 * @since	Version 1.0.0
 */
class Express {
    
    private $appcode;
    
    public function __construct($config) {
        if(empty($config)){
            exit("appcode参数未设置");
        }
        $this->appcode=$config['code'];
    }

    public function getExpress($expressid) {
        $host = "http://jisukdcx.market.alicloudapi.com";
        $path = "/express/query";
        $method = "GET";
        $headers = array();
        array_push($headers, "Authorization:APPCODE " . $this->appcode);
        $querys = "number=" . $expressid . "&type=auto";
        $url = $host . $path . "?" . $querys;

        $curl = curl_init();
        curl_setopt($curl, CURLOPT_CUSTOMREQUEST, $method);
        curl_setopt($curl, CURLOPT_URL, $url);
        curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);
        curl_setopt($curl, CURLOPT_FAILONERROR, false);
        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($curl, CURLOPT_HEADER, false);
        $express_json =  curl_exec($curl);
        return json_decode($express_json, true);
    }

}
